<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"> 
<#include "/header-smart.html" />
<#import "/macro/billMacro.html" as bill>
<base href="${basePath}">
<link rel="stylesheet" href="static/dataview_styles.css" type="text/css" charset="utf-8">
<@bill.webixcss/>
<style>
    .myhover{
        background: #F4F5F9;
    }
</style>
<body>
<@bill.layout>
	<div class="row">
		<div class="row margin-left-10">
			<div class="col-sm-6 col-md-6 col-lg-6">
				<ul class="demo-btns" style="height: 30px;">
					<li><a id="addStocktake" href="javascript:void(0);" class="btn btn-sm btn-default"><i class="fa fa-gear fa-lg"></i> 新增</a></li>
				</ul>
			</div>
		</div>
		<hr class="simple margin-5">
	</div>
	<ul class="nav nav-tabs bordered">
		<li class="active">
			<a data-toggle="tab" class="tabs" href="#tab-nofinish"><span> 未完成 </span> </a>
		</li>
		<li>
			<a data-toggle="tab" class="tabs" href="#tab-finish"><span> 已完成 </span> </a>
		</li>
	</ul>
	<div class="tab-content">
		<div class="tab-pane active" id="tab-nofinish">
			<div id="nofinish" style="width: 100%"></div>
		</div>
		<div class="tab-pane" id="tab-finish">
			<div id="finish"></div>
		</div>
	</div>
</@bill.layout>
</body>
<@bill.js/>
<script src="static/testdata.js"></script>
<script type="text/javascript">
	var u1,u2;
	var addIndex;
	$(document).ready(function() {
		pageSetUp();
		
		$("#addStocktake").on("click",function(){
			addIndex = layer.open({
				  type: 2,
				  skin: 'layui-layer-lan', //加上边框
				  area: ['600px', '400px'], //宽高
				  fixed: false, //不固定
				  content : "stocktake/addStocktakeMajor.do",
				  btn : [ '保存', '取消' ],
				  yes : function(index, layero) {
						var result = $(layero).find("iframe")[0].contentWindow.submitData();
						if (result) {
							var param = $("#billForm").serialize();
							param +="&querySql="+result.code;
							$.ajax({
						        type: "POST",
						        url: "transfer/addTransferItemBatch.do",
						        dataType: 'json',
						        data:encodeURI(param),
						        async: false,
						        success: function(data) {
						            if (data.status == '100') {
						            	reloadData(data.data);
						            	layer.close(index);
						            }else{
						            	layer.msg("导入符合条件的内容失败");
						            }
						        },
						        error: function() {
						        	layer.alert("连接服务器失败，请稍后重试");
						        }
						    });
						}
				}
			});
		})
		
		webix.i18n.setLocale("zh-CN");
		  u1=webix.ui({
				view:"dataview",
				container:"nofinish",
	            css: "movies",
	            type:{
	            	width: "auto",
	                template:"<div class='overall'><div class='rank'>#rank#.</div><div class='title'>#title#</div><div class='year'>#year# year</div> </div>"
	            },
	            tooltip:{
	                template:"<span class='webix_strong'>Rating: </span> #rating#<br/><span class='webix_strong'>Votes: </span> #votes#"
	            },
	            xCount:2,
	            height:parent.winHeight-240,
	            data:big_film_set
		});
		u2= webix.ui({
				view:"dataview",
				container:"finish",
				css: "movies",
	            type:{
	            	width: "auto",
	                template:"<div class='overall'><div class='rank'>#rank#.</div><div class='title'>#title#</div><div class='year'>#year# year</div> </div>"
	            },
	            tooltip:{
	                template:"<span class='webix_strong'>Rating: </span> #rating#<br/><span class='webix_strong'>Votes: </span> #votes#"
	            },
	            xCount:2,
	            height:parent.winHeight-240,
	            data:big_film_set
		});
		$('a[data-toggle="tab"]').on('shown.bs.tab', function (e) {
		  u1.adjust();
		  u2.adjust();
		})
	});
</script>
</html>