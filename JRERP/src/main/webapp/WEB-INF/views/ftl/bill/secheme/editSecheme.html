<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<#include "/header-smart.html" />
<link rel="stylesheet" type="text/css" media="screen"
	href="static/plugins/list-select/list-style.css">
<body>
	<div class="well">
		<div class="row form-body form-horizontal">
			<div class="col-lg-6 col-md-6 col-sm-6 no-padding">
				<div class="form-group margin-bottom-5 margin-right-5">
					<label class="col-lg-4 col-sm-4 control-label">方案名称：</label>
					<div class="col-lg-8 col-sm-8">
						<input type="hidden" id="id" name="id" class="form-control" value="${secheme.id}">
						<input type="text" id="name" name="name" class="form-control" value="${secheme.name}">
					</div>
				</div>
			</div>
			<div class="col-lg-6 col-md-6 col-sm-6 no-padding">
				<div class="form-group margin-bottom-5 margin-right-5">
					<label class="col-lg-4 col-md-4 col-sm-4 control-label">描述：</label>
					<div class="col-lg-8 col-md-8 col-sm-8">
						<input type="text" id="remarks" name="remarks" class="form-control" value="${secheme.remarks}">
					</div>
				</div>
			</div>
		</div>
		<div class="row">
			<div id="selectTitle" class="list-select" style="width:750px;">
				<div>
					<h4>请设置导入列（选项可拖动、双击、单击进行选择）</h4>
				</div>
				<div class="list-body" style="width:750px;">
					<ul class="item-box left-box" style="width:300px;">
						<li>
							<label style="margin-left:10px;width:80px;font-weight: bold;">列名</label>
							<label style="width:60px;font-weight: bold;">类型</label>
							<label style="width:60px;font-weight: bold;">小数位</label>
						</li>
						<#list allColumn as p>
							<li class="item" data-id="xigua">
								<label style="width:90px">${p.showName}
									<input type="hidden" name="showName" value="${p.showName}">
									<input type="hidden" name="dbColumn" value="${p.dbColumn}">
									<input type="hidden" name="paramType" value="${p.paramType}">
									<input type="hidden" name="beanColumn" value="${p.beanColumn}">
								</label>
								<label style="width:60px;">
									<#if p.paramType == "0">字符串</#if><#if p.paramType == "1">整数</#if>
									<#if p.paramType == "2">小数</#if><#if p.paramType == "3">基础类型</#if>
								</label>
								<#if p.paramType == "2">
									<label style="width:60px;">
										<select name='digits'>
											<option <#if p.digits == "0"> selected</#if> >0</option>
											<option <#if p.digits == "1"> selected</#if>>1</option>
											<option <#if p.digits == "2"> selected</#if>>2</option>
											<option <#if p.digits == "3"> selected</#if>>3</option>
										</select>
									</label>
								</#if>
							</li>
						</#list>
					</ul>
					<div class="center-box">
						<button class="add-one" title="添加选中项">></button>
						<button class="add-all" title="添加全部">>></button>
						<button class="remove-one" title="移除选中项"><</button>
						<button class="remove-all" title="移除全部"><<</button>
					</div>
					<ul id="selectedLi" class="item-box right-box" style="width:300px;">
						<li>
							<label style="margin-left:10px;width:80px;font-weight: bold;">列名</label>
							<label style="width:60px;font-weight: bold;">类型</label>
							<label style="width:60px;font-weight: bold;">小数位</label>
						</li>
					</ul>
				</div>
				<div class="list-footer">
					<button class="selected-val" title="获取选择值，输出到控制台">GET</button>
				</div>
			</div>
			</div>
		</div>
</body>
<script src="static/js/libs/jquery-3.2.1.min.js"></script>
<script src="static/js/app.config.js"></script>
<script src="static/js/bootstrap/bootstrap.min.js"></script>
<script src="static/js/smartwidgets/jarvis.widget.min.js"></script>
<script src="static/js/app.js?v=1"></script>
<script src="static/plugins/bootstrap-select/js/bootstrap-select.js"></script>
<script
	src="static/plugins/bootstrap-select/js/i18n/defaults-zh_CN.min.js"></script>
<script src="resource/layui/layui.all.js?v=1"></script>
<script src="static/plugins/list-select/list-script.js?v=1"></script>
<script src="static/js/libs/jquery-ui.min.js"></script>
<script type="text/javascript">
	$(document).ready(function() {
		pageSetUp();
		$('#selectTitle').initList({
			openDrag : true,
			openDblClick : true
		});

	});
	
	function submitData(){
		
		var param={};
		//param.id=$("#id").val();
		//param.name=$("#name").val();
		//param.remarks=$("#remarks").val();
		
		var selectedArr=[];
		$("#selectedLi").find(".item").each(function(){
			var obj={};
			obj.showName=$(this).find("[name='showName']").val();
			obj.dbColumn=$(this).find("[name='dbColumn']").val();
			obj.paramType=$(this).find("[name='paramType']").val();
			if(obj.paramType ==2){
				obj.digits=$(this).find("[name='digits']").val();
			}
			obj.beanColumn=$(this).find("[name='beanColumn']").val();
			selectedArr.push(obj);
		})
		param.itemList=selectedArr;
		var index = parent.layer.getFrameIndex(window.name); //先得到当前iframe层的索引,提交 Ajax 成功后，关闭当前弹层并重载表格
		$.ajax({
	        type: "POST",
	        url: "purchaseSecheme/saveSecheme.do",
	        dataType: 'json',
	        async: false,
	        data: JSON.stringify(param),
	        contentType:"application/json",
	        success: function(data) {
	            if (data.status == '100') {
	            	layer.alert("保存成功");
	            	parent.layer.close(index); //再执行关闭 
	            }else{
	            	layer.alert("获取基础信息失败");
	            }
	        },
	        error: function() {
	        }
	    });
	}
	
</script>
</html>

