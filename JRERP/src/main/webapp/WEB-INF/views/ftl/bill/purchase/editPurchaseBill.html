<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"> 
<#include "/header-smart.html" />
<base href="${basePath}">
<link rel="stylesheet" type="text/css" href="static/plugins/handsontable/handsontable.full.min.css?v=21">
<style type="text/css">
</style>
<body>
	<section id="widget-grid">
		<!-- row -->
		<div class="row no-margin">
			<article class="col-sm-12 col-md-12 col-lg-12">
				<div class="jarviswidget" id="wid-id-5"
					data-widget-colorbutton="false" data-widget-editbutton="false"
					data-widget-togglebutton="false" data-widget-deletebutton="false"
					data-widget-fullscreenbutton="false"
					data-widget-custombutton="false" data-widget-sortable="false">
					<div class="widget-body">
						<div class="widget-body-toolbar no-padding-bottom">
							<div class="row margin-left-10">
								<div class="col-sm-4 col-md-4 col-lg-4">
									<ul class="demo-btns">
										<li><a href="javascript:void(0);"
											class="btn btn-sm btn-default"><i
												class="fa fa-gear fa-lg"></i> 新增</a></li>
										<li><a href="javascript:void(0);"
											class="btn btn-sm btn-default"><i
												class="fa fa-gear fa-lg"></i> 打印</a></li>
										<li><a href="javascript:void(0);"
											class="btn btn-sm btn-default"><i
												class="fa fa-gear fa-lg"></i> 预览</a></li>
									</ul>
								</div>
								<div class="col-sm-8 col-md-8 col-lg-8">
									<a id="activity" class="activity-dropdown btn btn-sm btn-default"  href="javascript:void(0);" style="margin-left: 160px;" onclick="viewImportBill()"><i class="fa fa-gear fa-lg"></i> 导入</a>
								</div>
								</div>
							</div> 
							<div class="row margin-left-10">
								<form class="form-horizontal" role="form">
									<div class="row margin-bottom-5">
										<div class="form-group col-sm-3 col-md-3 col-lg-3">
											<label class="col-md-4 col-sm-6 control-label">供应商</label>
											<div class="col-md-8 col-sm-6 no-padding">
												<select id="supplier" name="supplier" class="form-control selectpicker show-tick" data-live-search="true">
													<#list supplierList as p>
														<option value='${p}'>${p}</option>
													</#list>
												</select>
											</div>
										</div>
										<div class="form-group col-sm-3 col-md-3 col-lg-3">
											<label class="col-md-4 col-sm-6 control-label">进货类型</label>
											<div class="col-md-8 col-sm-6 no-padding">
												<select id="purchaseType" name="purchaseType" class="form-control selectpicker show-tick" data-live-search="true">
													<#list purchaseTypeList as p>
														<option value='${p}'>${p}</option>
													</#list>
												</select>
											</div>
										</div>
										<div class="form-group col-sm-3 col-md-3 col-lg-3">
											<label class="col-md-4 col-sm-6 control-label">进货门店</label>
											<div class="col-md-8 col-sm-6 no-padding">
												<select id="deptAreaCode" name="deptAreaCode" class="form-control selectpicker show-tick" title="请选择门店/部门" data-live-search="true">
													<#list areaList as p>
														<option value='${p.areaCode}' <#if p.areaType == 0>data-icon="fa fa-bank" data-subtext="总公司"</#if> <#if p.areaType == 1>data-icon="fa fa-cubes" data-subtext="区域"</#if> <#if p.areaType == 2>data-icon="fa fa-cab" data-subtext="门店"</#if> >${p.areaName}</option>
													</#list>
												</select>
											</div>
										</div>
										<div class="form-group col-sm-3 col-md-3 col-lg-3">
											<label class="col-md-4 col-sm-6 control-label">进货柜台</label>
											<div class="col-md-8 col-sm-6 no-padding">
												<select id="storeAreaCode" name="storeAreaCode" class="form-control selectpicker show-tick" title="请选择柜台" data-live-search="true">
												</select>
											</div>
										</div>
										<div class="form-group col-sm-3 col-md-3 col-lg-3">
											<label class="col-md-4 col-sm-6 control-label">进货日期</label>
											<div class="col-md-8 col-sm-6 no-padding">
												<input type="text" class="form-control input-sm" id="sheetDate" name="sheetDate"  onclick="laydate()" >
											</div>
										</div>
										<div class="form-group col-sm-3 col-md-3 col-lg-3">
											<label class="col-md-4 col-sm-6 control-label">单号</label>
											<div class="col-md-8 col-sm-6 no-padding">
												<input type="text" class="form-control" id="firstname" placeholder="请输入名字">
											</div>
										</div>
										<div class="form-group col-sm-3 col-md-3 col-lg-3">
											<label class="col-md-4 col-sm-6 control-label">品牌</label>
											<div class="col-md-8 col-sm-6 no-padding">
												<select id="purchaseType" name="purchaseType" class="form-control selectpicker show-tick" data-live-search="true">
													<#list brandNameList as p>
														<option value='${p}'>${p}</option>
													</#list>
												</select>
											</div>
										</div>
										<div class="form-group col-sm-3 col-md-3 col-lg-3">
											<label class="col-md-4 col-sm-6 control-label">备注</label>
											<div class="col-md-8 col-sm-6 no-padding">
												<input type="text" id="remarks" name="remarks" class="form-control"  placeholder="请输入名字">
											</div>
										</div>
									</div>
								</form>
							</div>
						</div>
					</div>
				</div>
				<div class="well">
					<div id='hot' class="hot handsontable htRowHeaders htColumnHeaders" style="overflow: hidden;"></div>
				</div>
			</article>
		</div>
	</section>
</body>
<script src="static/js/libs/jquery-3.2.1.min.js"></script>
<script src="static/js/app.config.js"></script>
<script src="static/js/bootstrap/bootstrap.min.js"></script>
<script src="static/js/smartwidgets/jarvis.widget.min.js"></script>
<script src="static/js/app.js?v=2"></script>
<script src="static/plugins/bootstrap-select/js/bootstrap-select.js"></script>
<script src="static/plugins/bootstrap-select/js/i18n/defaults-zh_CN.min.js"></script>
<script src="static/plugins/handsontable/handsontable.full.js?v=3"></script>
<script src="static/plugins/handsontable/languages/zh-CN.js"></script>
<script src="static/plugins/layer/layer.js"></script>
<script src="static/plugins/laydate/laydate.js"></script>
<script type="text/javascript">
var hot1;
	var columns=[
		         {"data":'',renderer: operationRender,readOnly: true,title:'操作'},
		         {"data":"specialOffersFlag", readOnly: true,title:'一口价'},
		         {"data":"archivesNo",readOnly: true,title:'商品代码'},
		         {"data":"goodsName",readOnly: true,title:'商品名称',width:180},
		         {"data":"subGoodsName",readOnly: true,title:'子名称'},
		         {"data":"barCode",readOnly: true,title:'条码号'},
		         {"data" :'img', readOnly: true,title:'图片'},
		         {"data":"certificateNo",readOnly: true,title:'证书号'},
		         {"data":"giaCertificateNo",readOnly: true,title:'GIA证书号'},
		         {"data":"oldBarCode",readOnly: true,title:'原条码'},
		         {"data":"styleNo",readOnly: true,title:'款号'},
		         {"data":"unitPrice",readOnly: true,title:'单价',type:'numeric',format:'0.00'},
		         {"data": "num",readOnly: true,title:'数量',sum:true,type:'numeric',format:'0'},
		         {"data":"goldPrice",readOnly: true,title:'金价',type:'numeric',format:'0.00'},
		         {"data": "goldWeight",readOnly: true,title:'金重',sum:true,className:'htRight'},
		         {"data":"totalGoldWeight",readOnly: true,title:'总金重',sum:true,className:'htRight'},
		         {"data":"oldMaterialLoss",readOnly: true,title:'旧料损耗',type:'numeric',format:'0.000'},
		         {"data":"netGoldWeight",readOnly: true,title:'净金重',sum:true,className:'htRight'},
		         {"data":"worksFee4Ke",readOnly: true,title:'工费/克',type:'numeric',format:'0.00'},
		         {"data":"worksFee4Jian",readOnly: true,title:'工费/件',type:'numeric',format:'0.00'},
		         {"data":"worksFee4Total",readOnly: true,title:'工费总额',sum:true,type:'numeric'},
		         {"data":"certificateFee",readOnly: true,title:'证书费',type:'numeric',format:'0.00'},
		         {"data":"otherFee",readOnly: true,title:'其他费用',type:'numeric',format:'0.00'},
		         {"data":"fittingsFee",readOnly: true,title:'配件金额',type:'numeric',format:'0.00'},
		         {"data":"sandBlastFee",readOnly: true,title:'喷砂镶石',type:'numeric',format:'0.00'},
		         {"data":"costPrice",readOnly: true,title:'成本金额',sum:true,type:'numeric',format:'0.00'},
		         {"data":"markupRate",readOnly: true,title:'加价率',type:'numeric',format:'0.00'},
		         {"data":"labelPrice",readOnly: true,title:'标价',className:'htRight'},
		         {"data":"salePriceAmount",readOnly: true,title:'标价金额',sum:true,className:'htRight'},
		         {"data":"goodsWeight",readOnly: true,title:'商品总重',sum:true,className:'htRight'},
		         {"data":"mainType",readOnly: true,title:'核算分类'},
		         {"data":"shortCut",readOnly: true,title:'手寸'},
		         {"data":"goodsClassify",readOnly: true,title:'实际分类'},
		         {"data":"mainStoneClarity",readOnly: true,title:'净度'},
		         {"data":"mainStoneColor",readOnly: true,title:'颜色'},
		         {"data":"mainStoneCut",readOnly: true,title:'切工'},
		         {"data":"mainStoneFluorescent",readOnly: true,title:'荧光'},
		         {"data":"mainStoneSymmetry",readOnly: true,title:'对称性'},
		         {"data":"mainStoneBurnished",readOnly: true,title:'抛光'},
		         {"data":"peiShiCostPrice",readOnly: true,title:'配石成本',sum:true,type:'numeric',format:'0.00'},
		         {"data":"peiShiRate",readOnly: true,title:'配石倍率',type:'numeric',format:'0.00'},
		         {"data":"peiShiLabelPrice",readOnly: true,title:'配石标价',sum:true,className:'htRight'},
		         {"data":"mainStoneName",readOnly: true,title:'主石名称'},
		         {"data":"mainStoneNo",readOnly: true,title:'主石号'},
		         {"data": "mainStoneWeight",readOnly: true,title:'主石重',sum:true,className:'htRight'},
		         {"data":"mainStoneNum",readOnly: true,title:'主石粒数',sum:true,type:'numeric',format:'0'},
		         {"data":"mainStonePrice",readOnly: true,title:'主石价',type:'numeric',format:'0.00'},
		         //{"data":"mainStoneSpecifi",readOnly: true,title:'主石规格'},
		         {"data":"mainStoneMoney",readOnly: true,title:'主石金额',sum:true,type:'numeric',format:'0.00'},
		         {"data":"subStone1Name",readOnly: true,title:'副石名称'},
		         {"data":"subStone1No",readOnly: true,title:'副石号'},
		         {"data":"subStone1Weight",readOnly: true,title:'副石重',sum:true,className:'htRight'},
		         {"data":"subStone1Num",readOnly: true,title:'副石粒数',sum:true,type:'numeric',format:'0'},
		         {"data":"subStone1Price",readOnly: true,title:'副石价',type:'numeric',format:'0.00'},
		         //{"data":"subStone1Specifi",readOnly: true,title:'副石规格'},
		         {"data":"subStone1Money",readOnly: true,title:'副石金额',type:'numeric',format:'0.00',sum:true},
		         {"data":"subStone2Name",readOnly: true,title:'副石2名称'},
		         {"data":"subStone2No",readOnly: true,title:'副石2号'},
		         {"data":"subStone2Weight",readOnly: true,title:'副石2重',sum:true,className:'htRight'},
		         {"data":"subStone2Num",readOnly: true,title:'副石2粒数',sum:true,type:'numeric',format:'0'},
		         {"data":"subStone2Price",readOnly: true,title:'副石2价',type:'numeric',format:'0.00'},
		         //{"data":"subStone2Specifi",readOnly: true,title:'副石2规格'},
		         {"data":"subStone2Money",readOnly: true,title:'副石金额2',sum:true,type:'numeric',format:'0.00'},
		         {"data":"subStone3Name",readOnly: true,title:'副石名称3'},
		         {"data":"subStone3No",readOnly: true,title:'副石3号'},
		         {"data":"subStone3Weight",readOnly: true,title:'副石重3',sum:true,className:'htRight'},
		         {"data":"subStone3Num",readOnly: true,title:'副石粒数3',sum:true,type:'numeric',format:'0'},
		         {"data":"subStone3Price",readOnly: true,title:'副石价3',type:'numeric',format:'0.00'},
		         //{"data":"subStone3Specifi",readOnly: true,title:'副石规格3'},
		         {"data":"subStone3Money",readOnly: true,title:'副石金额3',sum:true,type:'numeric',format:'0.00'},
		         {"data":"subStone4Name",readOnly: true,title:'副石名称4'},
		         {"data":"subStone4No",readOnly: true,title:'副石石号4'},
		         {"data":"subStone4Weight",readOnly: true,title:'副石重4',sum:true,className:'htRight'},
		         {"data":"subStone4Num",readOnly: true,title:'副石粒数4',type:'numeric',format:'0'},
		         {"data":"subStone4Price",readOnly: true,title:'副石价4',type:'numeric',format:'0.00'},
		         //{"data":"subStone4Specifi",readOnly: true,title:'副石规格4'},
		         {"data":"subStone4Money",readOnly: true,title:'副石金额4',sum:true,type:'numeric',format:'0.00'},
		         {"data":"subStone5Name",readOnly: true,title:'副石名称5'},
		         {"data":"subStone5No",readOnly: true,title:'副石石号5'},
		         {"data":"subStone5Weight",readOnly: true,title:'副石重5',sum:true,className:'htRight'},
		         {"data":"subStone5Num",readOnly: true,title:'副石粒数5',sum:true,type:'numeric',format:'0'},
		         {"data":"subStone5Price",readOnly: true,title:'副石价5',type:'numeric',format:'0.00'},
		         //{"data":"subStone5Specifi",readOnly: true,title:'副石规格5'},
		         {"data":"subStone5Money",readOnly: true,title:'副石金额5',sum:true,type:'numeric',format:'0.00'},
		         {"data":"subStone6Name",readOnly: true,title:'副石名称6'},
		         {"data":"subStone6No",readOnly: true,title:'副石石号6'},
		         {"data":"subStone6Weight",readOnly: true,title:'副石重6',sum:true,className:'htRight'},
		         {"data":"subStone6Num",readOnly: true,title:'副石粒数6',sum:true,type:'numeric',format:'0'},
		         {"data":"subStone6Price",readOnly: true,title:'副石价6',type:'numeric',format:'0.00'},
		         //{"data":"subStone6Specifi",readOnly: true,title:'副石规格6'},
		         {"data":"subStone6Money",readOnly: true,title:'副石金额6',sum:true,type:'numeric',format:'0.00'},
		         {"data":"labelWorkFee4Ke",readOnly: true,title:'标签工费/克',type:'numeric',format:'0.00'},
		         {"data":"labelWorkFee4Jian",readOnly: true,title:'标签工费/件',type:'numeric',format:'0.00'},
		         {"data":"archivesFineness",readOnly: true,title:'成色'},
		         {"data":"archivesStone",readOnly: true,title:'石料'},
		         {"data":"archivesCategory",readOnly: true,title:'品类'},
		         {"data":"measurementMode",readOnly: true,title:'计量方式'},
		         {"data":"maoGoldWeight",readOnly: true,title:'毛金重',sum:true,className:'htRight'},
		         {"data":"goldLoss",readOnly: true,title:'损耗',type:'numeric',format:'0.00'},
		         {"data":"style",readOnly: true,title:'款式'},
		         {"data":"craft",readOnly: true,title:'工艺'},
		         {"data":"labelRemarks",readOnly: true,title:'标签备注'},
		         {"data":"remarks",readOnly: true,title:'备注'},
		         {"data":"sheetDate",readOnly: true,title:'进货日期'},
		         {"data":"supplierName",readOnly: true,title:'供应商'}];
	$(document).ready(function() {
		pageSetUp();
		var example = document.getElementById('hot');
		hot1 = new Handsontable(example, {
			data : [],
			height : 400,
			stretchH : "all",
			width : "100%",
			rowHeights : 23,
			rowHeaders : true,
			colHeaders : true,
			contextMenu : true,
			language : "zh-CN",
			columns: columns,
			multiColumnSorting : true
		});
		
		$("#canUseBtn").on("click",function(){
			$(this).parent().find("label").removeClass("active");
			$(this).addClass('active');
			$("#canUseSechemeUL").show();
			$("#noUseSechemeUL").hide();
		})
		$("#noUseBtn").on("click",function(){
			$(this).parent().find("label").removeClass("active");
			$(this).addClass('active');
			$("#canUseSechemeUL").hide();
			$("#noUseSechemeUL").show();
		})
		
		$("#deptAreaCode").on("change",function(){
			$("#storeAreaCode").html("");
			$.ajax({
		        type: "POST",
		        url: "sysAreaInfo/getStoreList.do?parentAreaCode="+$(this).val(),
		        dataType: 'json',
		        async: false,
		        success: function(data) {
		            if (data.status == '100') {
		            	var storeList=data.data;
		            	for(var index=0;index<storeList.length;index++){
		            		var store=storeList[index];
			            	$("#storeAreaCode").append("<option value='"+store.areaCode+"'>"+store.areaName+"</option>");
			            	$("#storeAreaCode").selectpicker('refresh');
		            	}
		            }else{
		            	layer.msg("获取柜台失败");
		            }
		        },
		        error: function() {
		        	layer.alert("连接服务器失败，请稍后重试");
		        }
		    });
		})
		laydate.render({
			  elem: '#sheetDate' //指定元素
			});
	});
	
	function select2Renderer(instance, td, row, col, prop, value, cellProperties)
	{
	    var selectedId;
	    for (var index = 0; index < optionsList.length; index++)
	    {
	        if (parseInt(value) === optionsList[index].id)
	        {
	            selectedId = optionsList[index].id;
	            value = optionsList[index].text;            
	        }
	    }
	    Handsontable.renderers.TextRenderer(instance, td, row, col, prop, value, cellProperties);
	}
	function editScheme(id) {
		//
		layer.open({
			type : 2,
			title : "新增/修改商品分类",
			area : [ '800px', '620px' ],
			shade : 0.8,
			scrollbar : false,
			id : 'lay_addClassify', //设定一个id，防止重复弹出
			btn : [ '保存', '取消' ],
			moveType : 1, //拖拽模式，0或者1
			content : "purchaseSecheme/editSecheme.do?sechemeId=" + id,
			yes : function(index, layero) {
				var result = $(layero).find("iframe")[0].contentWindow.submitData();
				if (result) {
				}
			}
		});
	}
	function viewImportBill(id){
		var index = layer.open({
			type : 2,
			title : "新增/修改商品分类",
			area : [ '800px', '620px' ],
			shade : 0.8,
			scrollbar : false,
			id : 'lay_addClassify', //设定一个id，防止重复弹出
			btn : false,
			moveType : 1, //拖拽模式，0或者1
			maxmin: true,
			content : "purchase/viewImportBill.do?sechemeId=" + id,
			yes : function(index, layero) {
				var result = $(layero).find("iframe")[0].contentWindow.submitData();
				if (result) {
				}
			}
		});
		layer.full(index);
	}
	
	function reloadData(billId){
		debugger
		if(billId){
			hot1.loadData(billId);
		}
	}
	function operationRender(instance, td,row){
	
		return td;
	}
</script>
</html>